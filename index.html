<!DOCTYPE html>
<html lang="en-US">
  <head>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
  </head>
<body>
<h1>COVID-19 CHARTS REAL TIME</h1>
<h3>Tính đến thời điểm: <span id="timeNow"></span></h3>

<div id="global"></div>
<div id="vietnam"></div>
<p><strong>Nếu biểu đồ không có dữ liệu số người tử vong tức là số người tử vong = 0</strong></p>

<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>

<script type="text/javascript">
$(document).ready(function() {
  $('#timeNow').text(new Date());
});

var getJSON = function(url, callback) {
            var xhr = new XMLHttpRequest();
            xhr.open('GET', url, true);
            xhr.responseType = 'json';
            
            xhr.onload = function() {
                var status = xhr.status;
                if (status == 200) {
                    callback(null, xhr.response);
                } else {
                    callback(status);
                }
            };
            
            xhr.send();
        };
      
        getJSON('https://api.covid19api.com/summary', function (err, data2) {
            if (err != null) {
              console.error(err);
            } else {
              // Load google charts
              google.charts.load('current', { 'packages': ['corechart'] });
              google.charts.setOnLoadCallback(drawChart);

              function drawChart() {
                //get data global
                var data = google.visualization.arrayToDataTable([
                  ['Task', 'Hours per Day'],
                  ['Tổng số ca mắc trên thế giới', parseInt(`${data2.Global.TotalConfirmed}`)],
                  ['Tổng số ca tử vong trên thế giới', parseInt(`${data2.Global.TotalDeaths}`)],
                  ['Tổng số ca đã khỏi bệnh trên thế giới', parseInt(`${data2.Global.TotalRecovered}`)]
                ]);
                var options = { 'title': 'Biểu đồ COVID-19 ở trên thế giới', 'width': 550, 'height': 400 };
                var chart = new google.visualization.PieChart(document.getElementById('global'));
                chart.draw(data, options);

                //get data viet nam
                var dataVietNam = google.visualization.arrayToDataTable([
                  ['Task', 'Hours per Day'],
                  ['Tổng số ca nhiễm ở Việt Nam', parseInt(`${data2.Countries[241].TotalConfirmed}`)],
                  ['Tổng số ca tử vong ở Việt Nam', parseInt(`${data2.Countries[241].TotalDeaths}`)],
                  ['Tổng số ca đã khỏi bệnh ở Việt Nam', parseInt(`${data2.Countries[241].TotalRecovered}`)]
                ]);
                var options2 = { 'title': 'Biểu đồ COVID-19 ở Việt Nam', 'width': 550, 'height': 400 };
                var chart2 = new google.visualization.PieChart(document.getElementById('vietnam'));
                chart2.draw(dataVietNam, options2);
              }
            }
        });
</script>

</body>
</html>